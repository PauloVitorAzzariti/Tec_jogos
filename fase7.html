<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fase 7 ‚Äì Classifique Hardware ou Software</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #141E30, #243B55);
      color: white;
      text-align: center;
    }

    h1 { margin: 16px 8px 8px; }

    /* HUD */
    #hud{
      display:flex; gap:16px; justify-content:center; align-items:center; flex-wrap:wrap;
      margin-top: 6px;
    }
    .pill{
      border:2px solid #00e676;
      border-radius:10px;
      padding:8px 14px;
      background: rgba(255,255,255,.06);
      font-weight:700;
    }

    #itens {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
      min-height: 120px;
      padding: 0 12px;
    }

    .item {
      padding: 12px 20px;
      background: #00e5ff;
      color: black;
      border-radius: 8px;
      font-weight: bold;
      cursor: grab;
      user-select: none;
      transition: transform 0.2s ease, opacity .2s ease;
      touch-action: none; /* melhora o arraste em telas interativas */
    }
    .item[draggable="false"]{ cursor:not-allowed; opacity:.7; }

    .vibrar {
      animation: vibrar 0.4s ease;
    }
    @keyframes vibrar {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }

    .container-caixas {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 30px;
      flex-wrap: wrap;
      padding: 0 12px 12px;
    }

    .caixa {
      border: 3px dashed white;
      padding: 40px;
      border-radius: 12px;
      width: 300px;
      min-height: 150px;
      font-size: 18px;
    }

    .acerto {
      background: #00c853;
      color: white;
    }

    #popup {
      display: none;
      position: fixed;
      top: 30%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      padding: 25px 30px;
      border-radius: 12px;
      font-size: 18px;
      max-width: 420px;
      z-index: 999;
      box-shadow: 0 0 20px #000;
      text-align:left;
    }
    #popup strong{ color:#00e5ff; }
    #popup .actions{
      display:flex; gap:10px; justify-content:flex-end; margin-top:14px;
    }
    #popup button {
      padding: 8px 20px;
      border: none;
      background: #ff1744;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    #popup button.sec{ background:#00e676; color:#000; }

    #proximo {
      display: none;
      margin: 26px 0 18px;
      padding: 10px 25px;
      background: #00e676;
      color: #000;
      border: none;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    #proximo:hover { background: #00c853; }
  </style>
</head>
<body>

<h1>üß† Fase 7 ‚Äì Classifique apenas Hardware e Software</h1>

<div id="hud">
  <div class="pill" id="timer">‚è≥ Tempo: 01:00</div>
  <div class="pill" id="progress">Progresso: 0/9</div>
</div>

<div id="itens"></div>

<div class="container-caixas">
  <div class="caixa" id="hardware" ondragover="permitirSoltar(event)" ondrop="soltar(event, 'hardware')">
    üñ•Ô∏è √Årea de Hardware
  </div>

  <div class="caixa" id="software" ondragover="permitirSoltar(event)" ondrop="soltar(event, 'software')">
    üíæ √Årea de Software
  </div>
</div>

<div id="popup">
  <div id="mensagem"></div>
  <div class="actions">
    <button class="sec" id="btnTryAgain" style="display:none;">Tentar novamente</button>
    <button onclick="fecharPopup()">Fechar</button>
  </div>
</div>

<button id="proximo" onclick="next()">Avan√ßar para Fase 8</button>

<script>
  // -------------------------
  // Dados e estado
  // -------------------------
  const listaItens = [
    { nome: "Teclado", tipo: "hardware" },
    { nome: "Mouse", tipo: "hardware" },
    { nome: "Monitor", tipo: "hardware" },
    { nome: "CPU", tipo: "hardware" },
    { nome: "Placa-m√£e", tipo: "hardware" },
    { nome: "Word", tipo: "software" },
    { nome: "Excel", tipo: "software" },
    { nome: "Chrome", tipo: "software" },
    { nome: "PowerPoint", tipo: "software" },
    { nome: "Camiseta", tipo: "nenhum" },
    { nome: "Martelo", tipo: "nenhum" },
    { nome: "Banana", tipo: "nenhum" },
    { nome: "Chave de fenda", tipo: "nenhum" },
    { nome: "Sapato", tipo: "nenhum" },
    { nome: "P√£o", tipo: "nenhum" }
  ];

  let acertos = 0;
  const totalCorretos = 9;
  let jogoEncerrado = false;

  const itensDiv   = document.getElementById("itens");
  const timerEl    = document.getElementById("timer");
  const progressEl = document.getElementById("progress");
  const proximoBtn = document.getElementById("proximo");
  const btnTryAgain = document.getElementById("btnTryAgain");

  // -------------------------
  // Cron√¥metro (1 minuto)
  // -------------------------
  const DURACAO = 60; // segundos
  let restante = DURACAO;
  let tId = null;

  function fmt(seg) {
    const m = String(Math.floor(seg/60)).padStart(2,'0');
    const s = String(seg%60).padStart(2,'0');
    return `${m}:${s}`;
  }
  function atualizarTimer(){
    timerEl.textContent = `‚è≥ Tempo: ${fmt(restante)}`;
  }
  function iniciarTimer(){
    atualizarTimer();
    tId = setInterval(()=>{
      if (jogoEncerrado) { clearInterval(tId); return; }
      restante--;
      atualizarTimer();
      if (restante <= 0) {
        clearInterval(tId);
        tempoEsgotado();
      }
    },1000);
  }
  function tempoEsgotado(){
    jogoEncerrado = true;
    bloquearArraste(true);
    if (navigator.vibrate) navigator.vibrate(200);
    mostrarPopup("‚õî <strong>Tempo esgotado!</strong> Voc√™ perdeu esta fase. Tente novamente.");
    btnTryAgain.style.display = "inline-block";
  }

  // -------------------------
  // Render itens (embaralhar)
  // -------------------------
  listaItens.sort(() => 0.5 - Math.random());
  listaItens.forEach(item => {
    const el = document.createElement('div');
    el.className = "item";
    el.textContent = item.nome;
    el.setAttribute("draggable", true);
    el.dataset.tipo = item.tipo;

    el.addEventListener("dragstart", e => {
      if (jogoEncerrado) { e.preventDefault(); return; }
      e.dataTransfer.setData("nome", item.nome);
      e.dataTransfer.setData("tipo", item.tipo);
    });

    itensDiv.appendChild(el);
  });

  // -------------------------
  // DnD
  // -------------------------
  function permitirSoltar(e) {
    if (jogoEncerrado) return;
    e.preventDefault();
  }

  function soltar(e, tipoAlvo) {
    if (jogoEncerrado) return;
    e.preventDefault();
    const nome = e.dataTransfer.getData("nome");
    const tipo = e.dataTransfer.getData("tipo");

    const elOriginal = Array.from(document.querySelectorAll('.item'))
      .find(el => el.textContent === nome && !el.classList.contains("acerto"));
    if (!elOriginal) return;

    if (tipo === "nenhum") {
      mostrarPopup("‚ùå Este item n√£o pertence a nenhuma das categorias. Ignore.");
      animarErro(elOriginal);
      return;
    }

    if (tipo === tipoAlvo) {
      const novo = document.createElement("div");
      novo.className = "item acerto";
      novo.textContent = nome;
      document.getElementById(tipoAlvo).appendChild(novo);
      acertos++;
      progressEl.textContent = `Progresso: ${acertos}/${totalCorretos}`;
      elOriginal.remove();
      verificarAcertos();
    } else {
      const dica = tipoAlvo === "hardware"
        ? "‚ùå Esse objeto n√£o √© um hardware!<br><br>üí° <strong>Hardware</strong> √© a parte f√≠sica do computador: pe√ßas como teclado, mouse e monitor."
        : "‚ùå Esse objeto n√£o √© um software!<br><br>üí° <strong>Software</strong> s√£o os programas que rodam no computador: como Word, Excel e navegadores.";
      mostrarPopup(dica);
      animarErro(elOriginal);
    }
  }

  // -------------------------
  // UI helpers
  // -------------------------
  function animarErro(el) {
    el.classList.add("vibrar");
    if (navigator.vibrate) navigator.vibrate(120);
    setTimeout(() => el.classList.remove("vibrar"), 600);
  }

  function mostrarPopup(mensagem) {
    document.getElementById("mensagem").innerHTML = mensagem;
    document.getElementById("popup").style.display = "block";
  }
  function fecharPopup() {
    document.getElementById("popup").style.display = "none";
  }
  window.fecharPopup = fecharPopup; // mant√©m o onclick do HTML

  function verificarAcertos() {
    if (acertos >= totalCorretos) {
      jogoEncerrado = true;
      clearInterval(tId);
      mostrarPopup("‚úÖ Parab√©ns! Voc√™ classificou todos os itens corretamente!");
      proximoBtn.style.display = "inline-block";
      bloquearArraste(true);
    }
  }

  function bloquearArraste(flag){
    document.querySelectorAll('.item').forEach(el=>{
      el.setAttribute('draggable', String(!flag));
    });
  }

  function next() {
    window.location.href = "fase8.html";
  }
  window.next = next; // mant√©m o onclick do HTML

  // -------------------------
  // Tentar novamente
  // -------------------------
  btnTryAgain.addEventListener('click', ()=> {
    // reload simples garante reset da ordem e do tempo
    location.reload();
  });

  // start
  iniciarTimer();
  progressEl.textContent = `Progresso: ${acertos}/${totalCorretos}`;
</script>

</body>
</html>
